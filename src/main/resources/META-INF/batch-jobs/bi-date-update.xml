<?xml version="1.0" encoding="UTF-8"?>
<job id="bi-date-update" version="1.0" xmlns="http://xmlns.jcp.org/xml/ns/javaee">
    <listeners>
        <listener ref="jobMonitoringListener"/>
    </listeners>
    <step id="process-user-day" allow-start-if-complete="true">
        <batchlet ref="userDayBatchletEnhanced">
            <properties>
                <property name="userUuid" value="#{partitionPlan['userUuid']}"/>
                <property name="day"      value="#{partitionPlan['day']}"/>
            </properties>
        </batchlet>
        <partition>
            <mapper ref="userDayPartitionMapper">
                <properties>
                    <property name="startDate" value="#{jobParameters['startDate']}"/>
                    <property name="endDate" value="#{jobParameters['endDate']}"/>
                    <property name="threads" value="#{jobParameters['threads']}"/>
                </properties>
            </mapper>
            <analyzer ref="resultBasedPartitionAnalyzer"/>
            <collector ref="userDayBatchletEnhanced"/>
        </partition>
    </step>
</job>